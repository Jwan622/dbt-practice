[0m15:43:43.596685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd37f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabfa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f297340>]}


============================== 15:43:43.600831 | f56b9fe7-eb97-4a57-b6e5-cd98b5711eef ==============================
[0m15:43:43.600831 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:43:43.601357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jwan/Desktop/de-technical-assessment/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:43:43.684120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabfa60>]}
[0m15:43:43.696641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f627670>]}
[0m15:43:43.697310 [info ] [MainThread]: Registered adapter: postgres=1.5.4
[0m15:43:43.747907 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:43:43.748526 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:43:43.748843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f63abe0>]}
[0m15:43:44.190849 [debug] [MainThread]: 1699: static parser successfully parsed analytics/valid_and_bookable_routes.sql
[0m15:43:44.201025 [debug] [MainThread]: 1699: static parser successfully parsed analytics/redemption_bookings_number_by_day.sql
[0m15:43:44.203375 [debug] [MainThread]: 1699: static parser successfully parsed analytics/ticket_sales_counts.sql
[0m15:43:44.232946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8e7e50>]}
[0m15:43:44.237762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f63a8b0>]}
[0m15:43:44.238108 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:43:44.238398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7f7fd0>]}
[0m15:43:44.239490 [info ] [MainThread]: 
[0m15:43:44.240030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:44.240818 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bookings'
[0m15:43:44.248448 [debug] [ThreadPool]: Using postgres connection "list_bookings"
[0m15:43:44.248707 [debug] [ThreadPool]: On list_bookings: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "connection_name": "list_bookings"} */

    select distinct nspname from pg_namespace
  
[0m15:43:44.248941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:44.590918 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:43:44.594000 [debug] [ThreadPool]: On list_bookings: Close
[0m15:43:44.596820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bookings, now list_bookings_dbt)
[0m15:43:44.602400 [debug] [ThreadPool]: Using postgres connection "list_bookings_dbt"
[0m15:43:44.602689 [debug] [ThreadPool]: On list_bookings_dbt: BEGIN
[0m15:43:44.602889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:44.631331 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:44.632164 [debug] [ThreadPool]: Using postgres connection "list_bookings_dbt"
[0m15:43:44.632996 [debug] [ThreadPool]: On list_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "connection_name": "list_bookings_dbt"} */
select
      'bookings' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'bookings' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:43:44.656391 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:43:44.659297 [debug] [ThreadPool]: On list_bookings_dbt: ROLLBACK
[0m15:43:44.660486 [debug] [ThreadPool]: On list_bookings_dbt: Close
[0m15:43:44.671890 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:44.672616 [debug] [MainThread]: On master: BEGIN
[0m15:43:44.673081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:44.687862 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:44.688276 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:44.688599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:44.737354 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m15:43:44.742705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f95e880>]}
[0m15:43:44.743613 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:44.744825 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:44.745359 [debug] [MainThread]: On master: BEGIN
[0m15:43:44.747022 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:44.747698 [debug] [MainThread]: On master: COMMIT
[0m15:43:44.748222 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:44.748717 [debug] [MainThread]: On master: COMMIT
[0m15:43:44.749692 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:44.750235 [debug] [MainThread]: On master: Close
[0m15:43:44.751661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:43:44.752809 [info ] [MainThread]: 
[0m15:43:44.762908 [debug] [Thread-1  ]: Began running node model.plaid_de.redemption_bookings_number_by_day
[0m15:43:44.764028 [debug] [Thread-2  ]: Began running node model.plaid_de.ticket_sales_counts
[0m15:43:44.764972 [debug] [Thread-3  ]: Began running node model.plaid_de.valid_and_bookable_routes
[0m15:43:44.766147 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.redemption_bookings_number_by_day .............. [RUN]
[0m15:43:44.767501 [info ] [Thread-2  ]: 2 of 3 START sql view model dbt.ticket_sales_counts ............................ [RUN]
[0m15:43:44.770374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_bookings_dbt, now model.plaid_de.redemption_bookings_number_by_day)
[0m15:43:44.768752 [info ] [Thread-3  ]: 3 of 3 START sql view model dbt.valid_and_bookable_routes ...................... [RUN]
[0m15:43:44.771981 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.plaid_de.ticket_sales_counts'
[0m15:43:44.772680 [debug] [Thread-1  ]: Began compiling node model.plaid_de.redemption_bookings_number_by_day
[0m15:43:44.773576 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.plaid_de.valid_and_bookable_routes'
[0m15:43:44.774042 [debug] [Thread-2  ]: Began compiling node model.plaid_de.ticket_sales_counts
[0m15:43:44.780587 [debug] [Thread-1  ]: Writing injected SQL for node "model.plaid_de.redemption_bookings_number_by_day"
[0m15:43:44.781051 [debug] [Thread-3  ]: Began compiling node model.plaid_de.valid_and_bookable_routes
[0m15:43:44.782650 [debug] [Thread-2  ]: Writing injected SQL for node "model.plaid_de.ticket_sales_counts"
[0m15:43:44.784320 [debug] [Thread-3  ]: Writing injected SQL for node "model.plaid_de.valid_and_bookable_routes"
[0m15:43:44.785386 [debug] [Thread-3  ]: Timing info for model.plaid_de.valid_and_bookable_routes (compile): 15:43:44.783006 => 15:43:44.785193
[0m15:43:44.785741 [debug] [Thread-2  ]: Timing info for model.plaid_de.ticket_sales_counts (compile): 15:43:44.781412 => 15:43:44.785579
[0m15:43:44.786036 [debug] [Thread-3  ]: Began executing node model.plaid_de.valid_and_bookable_routes
[0m15:43:44.786336 [debug] [Thread-2  ]: Began executing node model.plaid_de.ticket_sales_counts
[0m15:43:44.786717 [debug] [Thread-1  ]: Timing info for model.plaid_de.redemption_bookings_number_by_day (compile): 15:43:44.774356 => 15:43:44.786523
[0m15:43:44.828286 [debug] [Thread-3  ]: Writing runtime sql for node "model.plaid_de.valid_and_bookable_routes"
[0m15:43:44.829403 [debug] [Thread-2  ]: Writing runtime sql for node "model.plaid_de.ticket_sales_counts"
[0m15:43:44.829785 [debug] [Thread-1  ]: Began executing node model.plaid_de.redemption_bookings_number_by_day
[0m15:43:44.833400 [debug] [Thread-1  ]: Writing runtime sql for node "model.plaid_de.redemption_bookings_number_by_day"
[0m15:43:44.834007 [debug] [Thread-2  ]: Using postgres connection "model.plaid_de.ticket_sales_counts"
[0m15:43:44.834307 [debug] [Thread-1  ]: Using postgres connection "model.plaid_de.redemption_bookings_number_by_day"
[0m15:43:44.834591 [debug] [Thread-3  ]: Using postgres connection "model.plaid_de.valid_and_bookable_routes"
[0m15:43:44.834883 [debug] [Thread-2  ]: On model.plaid_de.ticket_sales_counts: BEGIN
[0m15:43:44.835143 [debug] [Thread-1  ]: On model.plaid_de.redemption_bookings_number_by_day: BEGIN
[0m15:43:44.835387 [debug] [Thread-3  ]: On model.plaid_de.valid_and_bookable_routes: BEGIN
[0m15:43:44.835625 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:43:44.835863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:43:44.836119 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:43:44.848687 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:44.849653 [debug] [Thread-2  ]: Using postgres connection "model.plaid_de.ticket_sales_counts"
[0m15:43:44.850210 [debug] [Thread-2  ]: On model.plaid_de.ticket_sales_counts: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.ticket_sales_counts"} */

  create view "bookings"."dbt"."ticket_sales_counts__dbt_tmp"
    
    
  as (
    WITH daily_ticket_sales AS (
    SELECT
        DATE_TRUNC('day', b.book_date) AS sale_date,
        COUNT(t.ticket_no) AS total_tickets
    FROM bookings b
    JOIN tickets t ON b.book_ref = t.book_ref
    GROUP BY sale_date
),

rolling_7d_ticket_sales AS (
    SELECT
        sale_date,
        SUM(total_tickets) OVER (ORDER BY sale_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS rolling_7_days_total
    FROM daily_ticket_sales
),

rolling_28d_ticket_sales AS (
    SELECT
        sale_date,
        SUM(total_tickets) OVER (ORDER BY sale_date ROWS BETWEEN 27 PRECEDING AND CURRENT ROW) AS rolling_28_days_total
    FROM daily_ticket_sales
)
SELECT
    dts.sale_date AS date,
    dts.total_tickets AS daily_total_tickets,
    rolling_7d.rolling_7_days_total,
    rolling_28d.rolling_28_days_total
FROM daily_ticket_sales dts
LEFT JOIN rolling_7d_ticket_sales AS rolling_7d
    ON dts.sale_date = rolling_7d.sale_date
LEFT JOIN rolling_28d_ticket_sales AS rolling_28d
    ON dts.sale_date = rolling_28d.sale_date
  );
[0m15:43:44.863198 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:44.863623 [debug] [Thread-3  ]: Using postgres connection "model.plaid_de.valid_and_bookable_routes"
[0m15:43:44.864089 [debug] [Thread-3  ]: On model.plaid_de.valid_and_bookable_routes: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.valid_and_bookable_routes"} */

  create view "bookings"."dbt"."valid_and_bookable_routes__dbt_tmp"
    
    
  as (
    WITH max_1_transfer_flights AS (
    SELECT
        route1.flight_no AS first_flight,
        route2.flight_no AS second_flight,
        route1.departure_airport AS first_departure_airport,
        route1.arrival_airport AS first_arrival_airport,
        route2.departure_airport AS second_departure_airport,
        route2.arrival_airport AS second_arrival_airport,
        route1.scheduled_departure as first_scheduled_departure_time,
        route2.scheduled_departure as second_scheduled_departure_time,
        route1.scheduled_arrival as first_scheduled_arrival_time,
        route2.scheduled_arrival as second_scheduled_arrival_time,
        route3.flight_no as third_flight,
        CASE
            WHEN route2.flight_no IS NULL THEN 1
            ELSE 0
        END AS is_transfer
    FROM routes AS route1
    LEFT OUTER JOIN routes AS route2
    ON route1.arrival_airport = route2.departure_airport
    LEFT OUTER JOIN routes AS route3
    ON route2.arrival_airport = route3.departure_airport
    AND route3.flight_no IS NULL
),
max_1_transfer_and_non_circular_flights AS (
  SELECT
    first_flight,
    second_flight,
    first_departure_airport,
    first_arrival_airport,
    second_departure_airport,
    second_arrival_airport,
    first_scheduled_departure_time,
    second_scheduled_departure_time,
    first_scheduled_arrival_time,
    second_scheduled_arrival_time,
    is_transfer
  FROM max_1_transfer_flights
  WHERE first_departure_airport <> second_arrival_airport -- non-circular
),
max_1_transfer_and_non_circular_flights_within_24h AS (
    SELECT *
    FROM max_1_transfer_and_non_circular_flights
    WHERE second_scheduled_arrival_time - first_scheduled_departure_time <= interval '24 hours'
)
SELECT
    first_flight as first_flight_no,
    second_flight as second_flight_no,
    first_departure_airport as origin_airport,
    first_scheduled_departure_time as first_scheduled_departure_time,
    COALESCE(second_arrival_airport, first_arrival_airport) as destination_airport_code,
    COALESCE(second_scheduled_arrival_time, first_scheduled_arrival_time) as destination_arrival_time,
    CASE WHEN second_flight IS NOT NULL THEN first_arrival_airport END as transfer_airport_code,
    CASE WHEN second_flight IS NOT NULL THEN first_scheduled_arrival_time END as transfer_airport_arrival_time,
    CASE WHEN second_flight IS NOT NULL THEN second_scheduled_departure_time END as transfer_airport_departure_time
FROM max_1_transfer_and_non_circular_flights_within_24h AS valid_routes
  );
[0m15:43:44.865695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:44.865970 [debug] [Thread-1  ]: Using postgres connection "model.plaid_de.redemption_bookings_number_by_day"
[0m15:43:44.866235 [debug] [Thread-1  ]: On model.plaid_de.redemption_bookings_number_by_day: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.redemption_bookings_number_by_day"} */

  create view "bookings"."dbt"."redemption_bookings_number_by_day__dbt_tmp"
    
    
  as (
    SELECT
    DATE_TRUNC('day', b.book_date) AS date,
    COUNT(*) AS redemption_count
FROM bookings b
WHERE total_amount = -1
    OR total_amount = 0
    OR total_amount = -12345678.00
GROUP BY date
ORDER BY redemption_count desc
  );
[0m15:43:44.884131 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:43:44.884421 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:43:44.891014 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:43:44.891451 [debug] [Thread-1  ]: Using postgres connection "model.plaid_de.redemption_bookings_number_by_day"
[0m15:43:44.894316 [debug] [Thread-2  ]: Using postgres connection "model.plaid_de.ticket_sales_counts"
[0m15:43:44.896750 [debug] [Thread-3  ]: Using postgres connection "model.plaid_de.valid_and_bookable_routes"
[0m15:43:44.897033 [debug] [Thread-1  ]: On model.plaid_de.redemption_bookings_number_by_day: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.redemption_bookings_number_by_day"} */
alter table "bookings"."dbt"."redemption_bookings_number_by_day" rename to "redemption_bookings_number_by_day__dbt_backup"
[0m15:43:44.897286 [debug] [Thread-2  ]: On model.plaid_de.ticket_sales_counts: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.ticket_sales_counts"} */
alter table "bookings"."dbt"."ticket_sales_counts" rename to "ticket_sales_counts__dbt_backup"
[0m15:43:44.897550 [debug] [Thread-3  ]: On model.plaid_de.valid_and_bookable_routes: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.valid_and_bookable_routes"} */
alter table "bookings"."dbt"."valid_and_bookable_routes" rename to "valid_and_bookable_routes__dbt_backup"
[0m15:43:44.900335 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:44.902842 [debug] [Thread-3  ]: Using postgres connection "model.plaid_de.valid_and_bookable_routes"
[0m15:43:44.903117 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:44.903351 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:44.903639 [debug] [Thread-3  ]: On model.plaid_de.valid_and_bookable_routes: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.valid_and_bookable_routes"} */
alter table "bookings"."dbt"."valid_and_bookable_routes__dbt_tmp" rename to "valid_and_bookable_routes"
[0m15:43:44.905838 [debug] [Thread-2  ]: Using postgres connection "model.plaid_de.ticket_sales_counts"
[0m15:43:44.908049 [debug] [Thread-1  ]: Using postgres connection "model.plaid_de.redemption_bookings_number_by_day"
[0m15:43:44.908404 [debug] [Thread-2  ]: On model.plaid_de.ticket_sales_counts: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.ticket_sales_counts"} */
alter table "bookings"."dbt"."ticket_sales_counts__dbt_tmp" rename to "ticket_sales_counts"
[0m15:43:44.908674 [debug] [Thread-1  ]: On model.plaid_de.redemption_bookings_number_by_day: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.redemption_bookings_number_by_day"} */
alter table "bookings"."dbt"."redemption_bookings_number_by_day__dbt_tmp" rename to "redemption_bookings_number_by_day"
[0m15:43:44.908977 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:44.916518 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:44.922633 [debug] [Thread-3  ]: On model.plaid_de.valid_and_bookable_routes: COMMIT
[0m15:43:44.922941 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:44.924445 [debug] [Thread-1  ]: On model.plaid_de.redemption_bookings_number_by_day: COMMIT
[0m15:43:44.924730 [debug] [Thread-3  ]: Using postgres connection "model.plaid_de.valid_and_bookable_routes"
[0m15:43:44.926106 [debug] [Thread-2  ]: On model.plaid_de.ticket_sales_counts: COMMIT
[0m15:43:44.926346 [debug] [Thread-1  ]: Using postgres connection "model.plaid_de.redemption_bookings_number_by_day"
[0m15:43:44.926564 [debug] [Thread-3  ]: On model.plaid_de.valid_and_bookable_routes: COMMIT
[0m15:43:44.926779 [debug] [Thread-2  ]: Using postgres connection "model.plaid_de.ticket_sales_counts"
[0m15:43:44.927038 [debug] [Thread-1  ]: On model.plaid_de.redemption_bookings_number_by_day: COMMIT
[0m15:43:44.927345 [debug] [Thread-2  ]: On model.plaid_de.ticket_sales_counts: COMMIT
[0m15:43:44.929564 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m15:43:44.933535 [debug] [Thread-3  ]: Using postgres connection "model.plaid_de.valid_and_bookable_routes"
[0m15:43:44.933775 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:43:44.934004 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:43:44.934286 [debug] [Thread-3  ]: On model.plaid_de.valid_and_bookable_routes: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.valid_and_bookable_routes"} */
drop view if exists "bookings"."dbt"."valid_and_bookable_routes__dbt_backup" cascade
[0m15:43:44.936069 [debug] [Thread-2  ]: Using postgres connection "model.plaid_de.ticket_sales_counts"
[0m15:43:44.937810 [debug] [Thread-1  ]: Using postgres connection "model.plaid_de.redemption_bookings_number_by_day"
[0m15:43:44.939623 [debug] [Thread-2  ]: On model.plaid_de.ticket_sales_counts: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.ticket_sales_counts"} */
drop view if exists "bookings"."dbt"."ticket_sales_counts__dbt_backup" cascade
[0m15:43:44.939917 [debug] [Thread-1  ]: On model.plaid_de.redemption_bookings_number_by_day: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "plaid-de", "target_name": "dev", "node_id": "model.plaid_de.redemption_bookings_number_by_day"} */
drop view if exists "bookings"."dbt"."redemption_bookings_number_by_day__dbt_backup" cascade
[0m15:43:44.949595 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:43:44.949894 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:43:44.950117 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:43:44.951204 [debug] [Thread-1  ]: Timing info for model.plaid_de.redemption_bookings_number_by_day (execute): 15:43:44.830213 => 15:43:44.951060
[0m15:43:44.952197 [debug] [Thread-3  ]: Timing info for model.plaid_de.valid_and_bookable_routes (execute): 15:43:44.786907 => 15:43:44.952065
[0m15:43:44.953156 [debug] [Thread-2  ]: Timing info for model.plaid_de.ticket_sales_counts (execute): 15:43:44.811091 => 15:43:44.953029
[0m15:43:44.953428 [debug] [Thread-1  ]: On model.plaid_de.redemption_bookings_number_by_day: Close
[0m15:43:44.953717 [debug] [Thread-3  ]: On model.plaid_de.valid_and_bookable_routes: Close
[0m15:43:44.954518 [debug] [Thread-2  ]: On model.plaid_de.ticket_sales_counts: Close
[0m15:43:44.955206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faf6b80>]}
[0m15:43:44.955808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb26be0>]}
[0m15:43:44.956233 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56b9fe7-eb97-4a57-b6e5-cd98b5711eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faccd90>]}
[0m15:43:44.957637 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.redemption_bookings_number_by_day ......... [[32mCREATE VIEW[0m in 0.19s]
[0m15:43:44.958160 [info ] [Thread-2  ]: 2 of 3 OK created sql view model dbt.ticket_sales_counts ....................... [[32mCREATE VIEW[0m in 0.18s]
[0m15:43:44.958641 [info ] [Thread-3  ]: 3 of 3 OK created sql view model dbt.valid_and_bookable_routes ................. [[32mCREATE VIEW[0m in 0.18s]
[0m15:43:44.959285 [debug] [Thread-1  ]: Finished running node model.plaid_de.redemption_bookings_number_by_day
[0m15:43:44.960264 [debug] [Thread-2  ]: Finished running node model.plaid_de.ticket_sales_counts
[0m15:43:44.960817 [debug] [Thread-3  ]: Finished running node model.plaid_de.valid_and_bookable_routes
[0m15:43:44.963053 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:44.963320 [debug] [MainThread]: On master: BEGIN
[0m15:43:44.963550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:44.976099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:44.976425 [debug] [MainThread]: On master: COMMIT
[0m15:43:44.976621 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:44.976802 [debug] [MainThread]: On master: COMMIT
[0m15:43:44.977146 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:44.977385 [debug] [MainThread]: On master: Close
[0m15:43:44.977883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:44.978098 [debug] [MainThread]: Connection 'model.plaid_de.redemption_bookings_number_by_day' was properly closed.
[0m15:43:44.978426 [debug] [MainThread]: Connection 'model.plaid_de.ticket_sales_counts' was properly closed.
[0m15:43:44.978694 [debug] [MainThread]: Connection 'model.plaid_de.valid_and_bookable_routes' was properly closed.
[0m15:43:44.979576 [info ] [MainThread]: 
[0m15:43:44.979888 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m15:43:44.980622 [debug] [MainThread]: Command end result
[0m15:43:44.985740 [info ] [MainThread]: 
[0m15:43:44.986093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:44.986359 [info ] [MainThread]: 
[0m15:43:44.986651 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:43:44.987202 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:44.987126 after 1.43 seconds
[0m15:43:44.987506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd37f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10face2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f924a60>]}
[0m15:43:44.987785 [debug] [MainThread]: Flushing usage events
